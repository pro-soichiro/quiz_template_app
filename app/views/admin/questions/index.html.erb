<section class="inner flex">
	<div class="sidebar">
		<h3>カテゴリ一覧</h3>
	  <% @categories.each do |category| %>
	    <%= link_to category.name , admin_questions_path(category: category.id) %>
	  <% end %>
	</div>

	<div class="content">
		<% if params[:category] %>
			<h2 class="section-ttl"><%= @category.name %>の問題一覧 (全<%= @all_questions_count %>問)</h2>
		<% else %>
			<h2 class="section-ttl">最近追加された問題</h2>
		<% end %>

		<h3 class="text-right">
			<%= link_to "新規作成", new_admin_question_path , data: {"turbolinks" => false} ,class: "btn btn-success" %>
		</h3>

		<% if @questions.first %>
			<table class="questions has_border">
				<thead>
					<tr>
						<th>問題番号</th>
						<th>問題文</th>
						<th>選択肢</th>
						<% unless params[:category] %>
							<th>カテゴリ</th>
						<% end %>
						<th></th>
					</tr>
				</thead>
				<tbody>
					<% @questions.each do |question| %>
						<tr>
							<td><%= question.id %></td>
							<td>
								<% if question.image_id %>
									<%= attachment_image_tag question,:image, :fill, 100, 100,format: 'jpeg' %><br />
								<% end %>
								<%= question.question_text %>
							</td>
							<td>
							  <% question.choices.each do |choice| %>
							  	<% if choice.is_answer? %>
							  		<p class="correct">正解<%= choice.choice_text %>
			            <% else %>
			            	<p><%= choice.choice_text %>
			            <% end %>
			            </p>
			          <% end %>
							</td>
							<% unless params[:category] %>
							<td><%= question.category.name %></td>
							<% end %>
							<td class="text-center">
							  <%= link_to "編集", edit_admin_question_path(question),
							  										data: {"turbolinks" => false},
							  										class: "btn btn-caution mb2" %><br/>
							  <%= link_to "削除", admin_question_path(question),
							  										method: :delete,
							  										class: "btn btn-danger",
							  										"data-confirm" => "問題番号【#{question.id}】の問題を削除します。よろしいでしょうか？"%>
							</td>
						</tr>
					<% end %>
				</tbody>
			</table>
		<% else %>
			<h3>問題はまだありません。</h3>
		<% end %>

		<% if params[:category] %>
			<%= paginate @questions %>
		<% end %>
	</div>
</section>